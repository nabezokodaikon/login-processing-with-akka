<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Login Example</title>
  </head>
  <body>
    <a href="/">Index</a>
    <h1>Login</h1>
    <form action="/doLogin" method="POST">
      <div>
        <label for="userId">User ID</label>
        <input id="userId" name="userId" type="text">
      </div>
      <div>
        <label for="password">Password</label>
        <input id="password" name="password" type="password">
      </div>
      <div>
        <label for="isRememberMe">Remember me</label>
        <input id="isRememberMe" name="isRememberMe" type="checkbox">
      </div>
      <div>
        <input id="referrer" name="referrer" type="hidden">
      </div>
      <div id="loginFailed" style="display:none">
        <p>ID入力内容またはパスワードが間違っています。</p>
      </div>
      <div>
        <input type="submit" value="Send">
      </div>
    </form>
    <script type="text/javascript">

      const host = location.origin;
      const ref = document.referrer.replace(host, "");
      const path = location.pathname;

      console.log(`ref: ${ref}`);
      console.log(`path: ${path}`);

      if (ref.length > 1) {
        document.getElementById("loginFailed").style.display = "";
      } else {
        document.getElementById("loginFailed").style.display = "none";
      }

      if (path == "/login"){
        document.getElementById("loginFailed").style.display = "none";
      }

      if (ref == "/login"){
        document.getElementById("loginFailed").style.display = "";
      }

      if (path == "/login") {
        document.getElementById("referrer").value = "/";
      } else {
        document.getElementById("referrer").value = path;
      }

    </script>
  </body>
</html>
